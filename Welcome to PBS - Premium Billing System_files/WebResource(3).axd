function ActivateUnloadBlocker(e){if(unloadBlocker.parentNode!=null&&disableUnloadBlockerForNextUnload==false){unloadBlocker.style.display="block";unloadBlocker.focus();}disableUnloadBlockerForNextUnload=false;}document.body.style.cursor='auto';function SetupUnloadBlocker(){unloadBlocker=document.createElement("div");unloadBlocker.setAttribute('style','-moz-outline-style:none;');unloadBlocker.style.display='none';unloadBlocker.style.backgroundColor='white';unloadBlocker.style.filter='alpha(opacity=0)';unloadBlocker.style.opacity='0';unloadBlocker.style.textAlign='right';unloadBlocker.style.padding='10px';unloadBlocker.style.cursor='wait';unloadBlocker.style.zIndex='30000';unloadBlocker.style.position='absolute';unloadBlocker.style.left='0px';unloadBlocker.style.top='0px';unloadBlocker.style.borderWidth='0px';unloadBlocker.style.padding='0px';unloadBlocker.style.width='100%';unloadBlocker.style.height='100%';unloadBlocker.tabIndex=-1;var a=function(e){e.cancelBubble=true;e.returnValue=false;};unloadBlocker.hideFocus=true;var a=function(e){if(typeof(e)=='undefined'){e=window.event;}e.cancelBubble=true;e.returnValue=false;};unloadBlocker.onkeyup=a;unloadBlocker.onkeydown=a;unloadBlocker.onkeypress=a;unloadBlocker.onmouseout=a;unloadBlocker.onmouseover=a;unloadBlocker.onmouseenter=a;unloadBlocker.onblur=function(e){window.setTimeout(function(){unloadBlocker.focus();},0);};if(window.addEventListener){window.addEventListener('beforeunload',ActivateUnloadBlocker,false);}else{window.attachEvent('onbeforeunload',ActivateUnloadBlocker);}var b=function(e){document.body.appendChild(unloadBlocker);};if(window.addEventListener){window.addEventListener('load',b,false);}else{window.attachEvent('onload',b);}}SetupUnloadBlocker();